<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="./index.css">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KAKAO ClONE</title>
</head>
<body>
  <div id="main-img-wrapper">
    <img width="320" src="./coding_image.png" alt="coding_image">
  </div>
  <div id="intro-main">
    <p>이미 모두의 은행 카카오뱅크,</p>
    <p>함께 일해요.</p>
    <p id="join-us-text">Join us!</p>
    <img id="down-arrow-icon" src="./down-arrow.png" alt="down-arrow">
  </div>
  <ul id="list-item-wrapper">
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
    <li class="list-item">✌️류현식은어떻게강캐가되었나</li>
  </ul>
<main>
  <section id="panell-img">
    <img id="flying-santa-image"src="santa_flying.png" alt="flying-santa">
  </section>
  <section id="video-section">
    <div id="video-wrapper">
      <video id="video" muted loop src="http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4" type="video/mp4">

      </video>
      <div id="fixed-description">
        <div>혁신이 만든</div>
        <div>압도적인 성장</div>
      </div>
    </div>
  </section>
</main>


</body>
<script>
  const listWrapper = document.getElementById("list-item-wrapper");
  const listWrapperOffset = listWrapper.offsetTop
  const listStyleChangeStartY = window.innerHeight - listWrapperOffset + window.innerHeight/2 - 200
  const listStyleChangeEndY = 2150
  const listItems = document.querySelectorAll('.list-item')
  const eachPixel = (listStyleChangeEndY - listStyleChangeStartY) / listItems.length
  
  const panellImage = document.getElementById('panell-img')
  const flyingSanta = document.getElementById('flying-santa-image')

  const videoPlayBack = 500

  const videoElement = document.getElementById('video')
  const videoSection = document.getElementById('video-section')

  const videoWrapper = document.getElementById('video-wrapper')

  const fixedDescription = document.getElementById('fixed-description')

  function centerElement(elementId, video) {
    const element = document.getElementById(elementId);
    const parent = element.parentElement;
  
    if (window.scrollY > parent.offsetTop - ((document.documentElement.clientHeight - element.offsetHeight) / 2)) {
      element.style.position = "fixed";
      element.style.top = "50%";
      element.style.left = "50%";
      element.style.transform = "translate(-50%, -50%)"

      if  (video) {
        video.currentTime = (window.scrollY - videoSection.offsetTop) / videoPlayBack
      }
    } else {
      element.style.position = "relative";
      element.style.top = "initial";
      element.style.left = "initial";
      element.style.transform = "initial";
    }
  }

  videoElement.addEventListener("loadedmetadata", () => {
    document.getElementById("video-section").style.height = videoElement.duration * videoPlayBack + "px";
  })

  const fixedDescriptionAppearTiming = 3470
  const fixedDescriptionAppearEnd = 3800



  window.addEventListener("scroll", ()=> {
    if(document.getElementById("on")) document.getElementById("on").removeAttribute("id")

    if(window.scrollY > listStyleChangeStartY && window.scrollY < listStyleChangeEndY) {
      const valueIndex = Math.floor((window.scrollY - listStyleChangeStartY) / eachPixel)
      if(listItems[valueIndex]) listItems[valueIndex].id = "on"
    }
    const scrollYBottom = window.scrollY + document.documentElement.clientHeight 

    if (scrollYBottom > panellImage.offsetTop && scrollYBottom < panellImage.offsetTop + panellImage.offsetHeight + 100){
      const translateX = 80 - 80 * 1.3 * (scrollYBottom - panellImage.offsetTop) / (panellImage.offsetHeight + 100)
      const translateY = -13 + 13 * (scrollYBottom - panellImage.offsetTop) / (panellImage.offsetHeight + 100)
      const translateZ = 40 - 80 * (scrollYBottom - panellImage.offsetTop) / (panellImage.offsetHeight + 100)
      
      flyingSanta.style.transform = `translate(${translateX}px, ${translateY}px) rotate(${translateZ}deg)`
    }
    centerElement("video-wrapper", videoElement)

    if(window.scrollY > videoSection.offsetTop + videoSection.offsetHeight - (videoWrapper.offsetHeight + (document.documentElement.clientHeight - videoWrapper.offsetHeight)/2)){
      videoWrapper.style.position = "relative";
      videoWrapper.style.top = "initial";
      videoWrapper.style.left = "initial";
      videoWrapper.style.transform = `translateY(${videoSection.offsetHeight - videoWrapper.offsetHeight}px)`;  
    }

    if (window.scrollY > fixedDescriptionAppearTiming && window.scrollY < fixedDescriptionAppearEnd){
      fixedDescription.style.transform = `translateY(${fixedDescriptionAppearEnd - window.scrollY}px)`
      fixedDescription.style.opacity = (window.scrollY - fixedDescriptionAppearTiming) / (fixedDescriptionAppearEnd - fixedDescriptionAppearTiming);
    } else if (window.scrollY > fixedDescriptionAppearEnd) {
      fixedDescription.style.transform = `translateY(0px)`
      fixedDescription.style.opacity = 1
    } else {
      fixedDescription.style.transform = `translateY(100px)`
      fixedDescription.style.opacity = 0
    }

  })

</script>
</html>